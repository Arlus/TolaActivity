{% extends "base.html" %}

{% block bread_crumb %}
<ol class="breadcrumb">
  <li><a href="/indicators/home/{{ getPrograms.all.0.id|default:0 }}/0/0/">Indicators</a></li>
  <li class="active">Indicator Disaggregation Report</li>
</ol>
{% endblock %}

{% block page_title %} Indicator Disaggregation Report {% endblock %}

{% block content %}

    <div id="tdisrep_table_div" class="table-responsive">
        <table id="disrep_table" class="table table-bordered">
            <thead>
                <tr>
                    <th rowspan="2">IndicatorID</th>
                    <th rowspan="2">Indicator</th>
                    <th rowspan="2">Overall</th>
                    <th colspan="3">Disaggregation</th>
                </tr>
                <tr>
                    <th>Type</th>
                    <th>Label</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
            {% for row in data %}
                {% for d in row.disdata %}
                    <tr>
                        {% ifchanged row.IndicatorID %}
                            <td style="border-bottom:none;">{{row.IndicatorID}}</td>
                            <td style="border-bottom:none;">{{row.Indicator}}</td>
                            <td style="border-bottom:none;">{{row.Overall}}</td>
                        {% else %}
                            <td style="border-bottom:none; border-top:none;"></td>
                            <td style="border-bottom:none; border-top:none;"></td>
                            <td style="border-bottom:none; border-top:none;"></td>
                        {% endifchanged %}

                        {% ifchanged d.DType %}
                            <td style="border-bottom:none;">{{d.DType}}</td>
                        {% else %}
                            <td style="border-bottom:none; border-top:none;"></td>
                        {% endifchanged %}
                        <td>{{d.Disaggregation}}</td>
                        <td>{{d.Actuals}}</td>
                    </tr>
                {% endfor %}
            {% endfor %}
            </tbody>
        </table>
    </div>

    <script type="text/javascript">
        var disrep_table;
        $(document).ready(function() {
            disrep_table = $("#disrep_table").DataTable({
                bSort: false,
                iDisplayLength: 100,
                lengthMenu: [[20, 50, 100, -1], [20, 50, 100, "All"]],
                dom: "<'row'<'col-sm-2'B><'col-sm-5'l><'col-sm-5'f>>" + "<'row'<'col-sm-12'tr>>" + "<'row'<'col-sm-5'i><'col-sm-7'p>>",
                buttons: [
                    {
                        extend: 'csv',
                        title: 'Indicator Disaggregation Report',
                        text: 'Export to CSV',
                        exportOptions: { columns: "thead th:not(.noExport)" }
                    }
                ]
            });
        });

    </script>

{% endblock content %}
